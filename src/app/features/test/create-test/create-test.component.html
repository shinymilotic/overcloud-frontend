<div class="flex justify-center">
  <!-- <app-side-bar class="col-sm-0 col-s-0"></app-side-bar> -->

  <div class="mt-3 w-1/2">
    <app-list-errors [errors]="errors"></app-list-errors>

    <form [formGroup]="testForm" (ngSubmit)="submitForm()">
      <fieldset class="flex flex-col border-none" [disabled]="isSubmitting">
        <fieldset class="form-group mb-3">
          <input
            id="title"
            class="form-control form-control-lg w-full outline-none"
            formControlName="title"
            type="text"
            placeholder="Title"
          />
        </fieldset>

        <fieldset class="form-group mb-3">
          <input
            id="description"
            class="form-control form-control-lg w-full outline-none"
            formControlName="description"
            type="text"
            placeholder="Description"
          />
        </fieldset>
  
        <div formArrayName="questions">
          <div
            class="question p-2"
            *ngFor="let question of questionsFormArr.controls; let qIndex = index"
            [formGroupName]="qIndex"
          >
          <div class="flex">
            <fieldset class="form-group mb-3 w-full">
              <textarea
                id="question-{{ qIndex }}"
                class="form-control form-control-lg w-full outline-none"
                formControlName="question"
                placeholder="Câu hỏi"
              ></textarea>
            </fieldset>
            <a
              class="deleteQuestionBtn btn-outline-danger"
              (click)="deleteQuestion(qIndex)"
            >
              Delete
            </a>
          </div>
  
            <div *ngIf="this.isChoiceQuestion(qIndex)" formArrayName="answers">
              <div
                class="flex mb-2"
                *ngFor="
                  let answer of getAnswerFormArr(qIndex).controls;
                  let aIndex = index
                "
                [formGroupName]="aIndex"
              >
                <fieldset class="form-group mr-3">
                  <input
                    id="{{ aIndex }}"
                    class="form-control answer outline-none"
                    formControlName="answer"
                    type="text"
                    placeholder="Câu trả lời"
                    (keydown)="addAnswer(qIndex, $event)"
                  />
                </fieldset>
                <fieldset class="form-group mr-3 truth-fieldset">
                  <label class="checkmark-fieldset">
                    <input
                      class="form-control outline-none border-none"
                      formControlName="truth"
                      type="checkbox"
                    />
                    <span class="checkmark"></span>
                  </label>  
                </fieldset>
                  
                <a
                  class="deleteAnswerBtn btn-outline-danger"
                  (click)="deleteAnswer(qIndex, aIndex)"
                >
                  Delete
                </a>

                <br>
              </div>
              <a
                class="addAnswerBtn"
                (click)="addAnswer(qIndex)"
              >
                Add answer
              </a>
            </div>
          </div>
        </div>
  
        <div>
          <button
            type="button"
            class="addQuestionBtn overcloud-btn"
            (click)="addQuestion()"
          >
            Add choice question
          </button>&nbsp; 
  
          <button
            type="button"
            class="addQuestionBtn overcloud-btn"
            (click)="addEssayQuestion()"
          >
            Add essay question
          </button>
        </div>
      </fieldset>
      <button class="overcloud-btn float-right mt-2" type="submit">
        Create test
      </button>
    </form>
  </div>
</div>
